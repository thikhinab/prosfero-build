(this.webpackJsonpprosfero=this.webpackJsonpprosfero||[]).push([[0],{127:function(e,t,c){},128:function(e,t,c){},129:function(e,t,c){},154:function(e,t,c){},156:function(e,t,c){"use strict";c.r(t);var n=c(1),a=c.n(n),s=c(28),r=c.n(s),o=(c(90),c(3)),i=c(7),l=c(5),j=c(8),d=c.n(j),u=c(13),b=c(4),m=c.n(b),h=c(0),O=function(e){var t=e.loggedin,c=e.func,a=Object(l.g)(),s=Object(n.useState)(""),r=Object(o.a)(s,2),j=r[0],d=r[1];return Object(h.jsx)("nav",{className:"navbar navbar-expand-lg navbar-dark bg-primary",children:Object(h.jsxs)("div",{className:"container-fluid",children:[Object(h.jsx)("span",{className:"navbar-brand",style:{fontFamily:"Dancing Script"},children:"Prosfero"}),Object(h.jsx)("button",{className:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation",children:Object(h.jsx)("span",{className:"navbar-toggler-icon"})}),Object(h.jsx)("div",{className:"collapse navbar-collapse",id:"navbarNav",children:t?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:[Object(h.jsx)("li",{className:"nav-item",children:Object(h.jsx)(i.b,{className:"nav-link",to:"/home",children:"Home"})}),Object(h.jsx)("li",{className:"nav-item",children:Object(h.jsx)(i.b,{className:"nav-link",to:"/profile",children:"Profile"})}),Object(h.jsx)("li",{className:"nav-item",children:Object(h.jsx)(i.b,{className:"nav-link",to:"/createpost",children:"Create Post"})}),Object(h.jsx)("li",{className:"nav-item",children:Object(h.jsx)(i.b,{className:"nav-link",to:"/chat",children:"Chat"})}),Object(h.jsx)("li",{className:"nav-item",children:Object(h.jsx)(i.b,{className:"nav-link",to:"/telebot",children:"Telebot"})}),Object(h.jsx)("li",{className:"nav-item",children:Object(h.jsx)("span",{className:"nav-link",onClick:function(){c(),a.push("/login")},children:"Logout"})})]}),Object(h.jsxs)("form",{className:"d-flex",style:{height:"2.5rem"},children:[Object(h.jsx)("input",{className:"form-control me-2",type:"search",placeholder:"Search","aria-label":"Search",onChange:function(e){d(e.target.value)}}),Object(h.jsx)("button",{className:"btn btn-outline-light",style:{margin:"0rem"},onClick:function(e){if(e.preventDefault(),!j.replace(/\s/g,"").length||""!==j)return a.push("/search?q=".concat(j))},children:"Search"})]})]}):Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:[Object(h.jsx)("li",{className:"nav-item",children:Object(h.jsx)(i.b,{className:"nav-link",to:"/registration",children:"Register"})}),Object(h.jsx)("li",{className:"nav-item",children:Object(h.jsx)(i.b,{className:"nav-link",to:"/login",children:"Login"})})]})})})]})})},p=Object(n.createContext)(null),x=c(39),f=c.n(x),v=function(){var e=Object(n.useRef)(),t=Object(l.g)(),c=Object(n.useContext)(p),a=c.user,s=c.setUser,r=Object(n.useState)(""),j=Object(o.a)(r,2),b=j[0],x=j[1],v=Object(n.useState)(""),g=Object(o.a)(v,2),N=g[0],y=g[1],k=Object(n.useState)({}),S=Object(o.a)(k,2),w=S[0],C=S[1],F=Object(n.useState)([]),I=Object(o.a)(F,2),D=I[0],U=I[1],P=Object(n.useState)([]),A=Object(o.a)(P,2),E=A[0],R=A[1],q="http://localhost:5000/api/v1/profile",B=function(){var e=Object(u.a)(d.a.mark((function e(){var t,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0!==N.selectedFile?(t=N.selectedFile,(c=new FormData).append("file",t),c.append("upload_preset","prosfero"),m.a.post("https://api.cloudinary.com/v1_1/drv2gra8s/image/upload",c).then((function(e){var t=e.data;x(t.secure_url);var c={profilePicture:t.secure_url};fetch(q,{method:"PUT",headers:{Authorization:"Bearer ".concat(a.token),"Content-Type":"application/json"},body:JSON.stringify(c)}).then((function(e){return console.log("Profile updated")})).catch((function(e){return console.log(e)}))})).catch((function(e){return console.log(e)}))):alert("Please select an Image");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){null!==a.token&&m.a.get(q,{headers:{Authorization:"Bearer ".concat(a.token)}}).then((function(e){C(e.data),x(e.data.profilePicture)})).catch((function(e){return alert(e)})),document.body.style="background: #b3e0ff;",m.a.get("http://localhost:5000/api/v1/requests",{headers:{Authorization:"Bearer ".concat(a.token)}}).then((function(e){U(e.data)})).catch((function(e){return alert(e)})),m.a.get("http://localhost:5000/api/v1/profile/notifs",{headers:{Authorization:"Bearer ".concat(a.token)}}).then((function(e){R(e.data)})).catch((function(e){return alert(e)}))}),[]);var z=function(e,t){e.preventDefault(),m.a.create({baseURL:"http://localhost:5000/api/v1",headers:{Authorization:"Bearer ".concat(a.token)}}).post("/profile/notifs/".concat(t.requestid)).then((function(e){console.log(e.data)})).catch((function(e){return alert(e)}))},L=function(e){return"approved"===e[5]?Object(h.jsxs)("div",{className:"card h-100",children:[Object(h.jsxs)("div",{className:"card-body",children:[Object(h.jsx)("h5",{className:"card-title",children:"Approved!"}),Object(h.jsxs)("p",{className:"card-text",children:["You approved ",e[1],"'s request on ",e[0]]}),Object(h.jsxs)("p",{className:"card-text",children:["Contact them at ",e[4]]})]}),Object(h.jsx)("button",{className:"btn btn-primary",onClick:function(){return c=e[6],void m.a.create({baseURL:"http://localhost:5000/api/v1",headers:{Authorization:"Bearer ".concat(a.token)}}).post("/conversations",{senderId:a.id,receiverId:c}).then((function(e){t.push("/chat")})).catch((function(e){return alert(e)}));var c},children:"Start Conversation"})]}):"declined"!==e[5]?Object(h.jsxs)("div",{className:"card h-100",children:[Object(h.jsxs)("div",{className:"card-body",children:[Object(h.jsx)("h5",{className:"card-title",children:e[0]})," ",Object(h.jsx)("h5",{className:"card-title",children:e[1]})," ",Object(h.jsx)("p",{className:"card-text",children:e[2]})," "]}),Object(h.jsx)("a",{href:"#",class:"btn btn-outline-success",onClick:function(t){return function(e,t){e.preventDefault(),m.a.create({baseURL:"http://localhost:5000/api/v1",headers:{Authorization:"Bearer ".concat(a.token)}}).post("/requests/approve/".concat(t[3])).then((function(e){alert("The email of the approved user is: ".concat(e.data))})).catch((function(e){return alert(e)}))}(t,e)},children:"Approve"}),Object(h.jsx)("a",{href:"#",class:"btn btn-outline-danger",onClick:function(t){return function(e,t){e.preventDefault();var c=m.a.create({baseURL:"http://localhost:5000/api/v1",headers:{Authorization:"Bearer ".concat(a.token)}});console.log(t),c.post("/requests/decline/".concat(t[3])).then((function(e){alert("The user's request has been declined"),console.log(e.data)})).catch((function(e){return alert(e)}))}(t,e)},children:"Decline"})]}):void 0};return!a.token||a.expired?Object(h.jsx)(l.a,{to:"/login"}):Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(O,{loggedin:!0,func:function(){localStorage.removeItem("prosfero-token"),localStorage.removeItem("prosfero-id"),s({token:null,id:null})}}),Object(h.jsxs)("div",{className:"profile-background",children:[Object(h.jsx)("div",{className:"container profile",children:Object(h.jsxs)("div",{className:"row",children:[Object(h.jsxs)("div",{className:"col",children:[Object(h.jsx)("div",{className:"text-center",style:{fontFamily:"Dancing Script"},children:Object(h.jsx)("h2",{children:"About you"})}),Object(h.jsxs)("div",{className:"profile-box text-center",children:[Object(h.jsxs)("div",{children:[Object(h.jsx)("h6",{style:{fontWeight:"bold"},children:"Name"}),Object(h.jsx)("p",{children:"".concat(w.firstName," ").concat(w.lastName)})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("h6",{style:{fontWeight:"bold"},children:"Email"}),Object(h.jsx)("p",{children:w.email})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("h6",{style:{fontWeight:"bold"},children:"Date Joined"}),Object(h.jsx)("p",{children:function(e){var t=new Date(e),c=t.getDate(),n=t.getMonth()+1;return c<10&&(c="0"+c),n<10&&(n="0"+n),c+"/"+n+"/"+t.getFullYear()}(w.createdAt)})]})]})]}),Object(h.jsxs)("div",{className:"col text-center",style:{margin:"1rem"},children:[b?Object(h.jsx)("img",{className:"profile-picture",src:b,alt:"profile pif"}):Object(h.jsx)("div",{style:{margin:"3rem"},children:Object(h.jsx)(f.a,{style:{transform:"scale(5)"}})}),Object(h.jsx)("input",{style:{display:"none"},type:"file",name:"file",placeholder:"Upload Profile Picture",onChange:function(e){y({selectedFile:e.target.files[0]})},ref:e}),Object(h.jsxs)("div",{className:"d-grid gap-2 d-md-block",style:{margin:"1rem"},children:[Object(h.jsx)("button",{type:"button",className:"btn btn-outline-primary btn-sm",style:{margin:"0.25rem"},onClick:function(){return e.current.click()},children:"Choose Profile Picture"}),Object(h.jsx)("button",{type:"button",className:"btn btn-outline-primary btn-sm",style:{margin:"0.25rem"},onClick:B,children:"Upload"})]}),Object(h.jsx)("h2",{style:{fontFamily:"Dancing Script",marginTop:"1rem"},children:w.username})]}),Object(h.jsxs)("div",{className:"col",children:[Object(h.jsx)("div",{className:"text-center",style:{fontFamily:"Dancing Script"},children:Object(h.jsx)("h2",{children:"Stats"})}),Object(h.jsxs)("div",{className:"profile-box text-center",children:[Object(h.jsxs)("div",{children:[Object(h.jsx)("h6",{style:{fontWeight:"bold"},children:"Posts"}),Object(h.jsx)("p",{children:w.noOfPosts||0})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("h6",{style:{fontWeight:"bold"},children:"Requests"}),Object(h.jsx)("p",{children:D.length})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("h6",{style:{fontWeight:"bold"},children:"Achievement Level"}),Object(h.jsx)("p",{children:w.achievementLevel})]})]})]})]})}),Object(h.jsx)("div",{style:{color:"#b3e0ff"},children:"..."}),Object(h.jsxs)("div",{className:"container profile",children:[Object(h.jsx)("div",{className:"text-center",style:{fontFamily:"Dancing Script"},children:Object(h.jsx)("h2",{children:"Your Notifications"})}),E&&E.map((function(e){return"declined"===(t=e).status?Object(h.jsxs)("div",{class:"alert alert-warning alert-dismissible fade show",role:"alert",children:["Your request on ",Object(h.jsx)("strong",{children:t.title})," by"," ",Object(h.jsx)("strong",{children:t.username})," was declined",Object(h.jsx)("button",{type:"button",class:"btn-close","data-bs-dismiss":"alert","aria-label":"Close",onClick:function(e){return z(e,t)}})]}):"approved"===t.status?Object(h.jsxs)("div",{class:"alert alert-success alert-dismissible fade show",role:"alert",children:["Your request on ",Object(h.jsx)("strong",{children:t.title})," by"," ",Object(h.jsx)("strong",{children:t.username})," was accepted! Check out the"," ",Object(h.jsx)("b",{children:"Your Requests"})," page",Object(h.jsx)("button",{type:"button",class:"btn-close","data-bs-dismiss":"alert","aria-label":"Close",onClick:function(e){return z(e,t)}})]}):void 0;var t}))]}),Object(h.jsx)("div",{style:{color:"#b3e0ff"},children:"..."}),Object(h.jsx)("div",{className:"text-center",children:Object(h.jsx)(i.b,{to:"/requests",class:"btn btn-primary",children:"Your Requests"})}),Object(h.jsxs)("div",{className:"container profile",children:[Object(h.jsx)("div",{className:"text-center",style:{fontFamily:"Dancing Script"},children:Object(h.jsx)("h2",{children:"Incoming Requests"})}),Object(h.jsx)("div",{class:"container px-4",children:Object(h.jsx)("div",{class:"row row-cols-1 row-cols-sm-2 row-cols-md-3 g-4 gx-5",children:D&&D.map((function(e){return L(e)}))})})]})]})]})},g=c(12),N=function(){var e=Object(l.g)();document.body.style="background: white";var t=Object(n.useContext)(p),c=t.user,a=t.setUser,s=Object(n.useState)({username:"",password:""}),r=Object(o.a)(s,2),i=r[0],j=r[1],d=function(e){var t=Object(g.a)({},i);t[e.target.name]=e.target.value,j(t)},u=function(e,t){return""!==e||(alert(t),!1)};return Object(h.jsx)(h.Fragment,{children:null!==c.token?Object(h.jsx)(l.a,{to:"profile"}):Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(O,{loggedin:!1}),Object(h.jsxs)("form",{className:"login-form",children:[Object(h.jsx)("div",{className:"text-center",children:Object(h.jsx)("h1",{id:"login-title",style:{fontFamily:"Dancing Script",fontSize:"3rem"},children:"Login"})}),Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("label",{className:"form-label",children:"Username"}),Object(h.jsx)("input",{type:"text",className:"form-control",name:"username",onChange:function(e){return d(e)},value:i.username})]}),Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("label",{className:"form-label",children:"Password"}),Object(h.jsx)("input",{type:"password",className:"form-control",name:"password",onChange:function(e){return d(e)},value:i.password,id:"registation-password"})]}),Object(h.jsx)("div",{className:"text-center",children:Object(h.jsx)("button",{type:"submit",className:"btn btn-primary",onClick:function(t){return function(t){t.preventDefault(),u(i.username,"Please enter the username")&&u(i.password,"Please enter the password")&&m.a.post("http://localhost:5000/api/v1/users/login",{username:i.username,password:i.password}).then((function(t){void 0===t.data.error?(localStorage.setItem("prosfero-token",t.data.token),localStorage.setItem("prosfero-id",t.data.id),a({token:t.data.token,id:t.data.id,expired:!1}),e.push("/profile")):alert(t.data.error)})).catch((function(e){return alert(e)})),j({username:"",password:""})}(t)},children:"Login"})})]})]})})},y=function(){var e=Object(n.useContext)(p).setUser;document.body.style="background: white";var t=Object(l.g)(),c=Object(n.useState)({firstName:"",lastName:"",username:"",email:"",password:""}),a=Object(o.a)(c,2),s=a[0],r=a[1],i=function(e){var t=Object(g.a)({},s);t[e.target.name]=e.target.value,r(t)};return Object(n.useEffect)((function(){localStorage.removeItem("prosfero-token"),localStorage.removeItem("prosfero-id"),e({token:localStorage.getItem("prosfero-token"),id:localStorage.getItem("prosfero-id")})}),[]),Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(O,{loggedin:!1}),Object(h.jsxs)("form",{className:"registration-form",children:[Object(h.jsx)("div",{className:"text-center",children:Object(h.jsx)("h1",{id:"registration-title",style:{fontFamily:"Dancing Script",fontSize:"3rem"},children:"Registration"})}),Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("label",{className:"form-label",children:"First name"}),Object(h.jsx)("input",{type:"text",className:"form-control",name:"firstName",onChange:function(e){return i(e)},value:s.firstName,id:"registration-first-name"})]}),Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("label",{className:"form-label",children:"Last name"}),Object(h.jsx)("input",{type:"text",className:"form-control",name:"lastName",onChange:function(e){return i(e)},value:s.lastName,id:"registration-last-name"})]}),Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("label",{className:"form-label",children:"Username"}),Object(h.jsx)("input",{type:"text",className:"form-control",name:"username",onChange:function(e){return i(e)},value:s.username,id:"registration-username"})]}),Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("label",{className:"form-label",children:"Email address"}),Object(h.jsx)("input",{type:"email",className:"form-control",name:"email",onChange:function(e){return i(e)},value:s.email,id:"registration-email"})]}),Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("label",{className:"form-label",children:"Password"}),Object(h.jsx)("input",{type:"password",className:"form-control",name:"password",onChange:function(e){return i(e)},value:s.password,id:"registation-password"})]}),Object(h.jsx)("div",{className:"text-center",children:Object(h.jsx)("button",{type:"submit",className:"btn btn-primary",onClick:function(e){return function(e){e.preventDefault(),m.a.post("http://localhost:5000/api/v1/users/register",{firstName:s.firstName,lastName:s.lastName,username:s.username,email:s.email,password:s.password}).then((function(e){console.log(e.data),alert("User Registered!"),t.push("/login")})).catch((function(e){return alert(e)})),r({firstName:"",lastName:"",username:"",email:"",password:""})}(e)},children:"Register"})})]})]})},k=function(){var e=Object(n.useContext)(p).user,t=Object(l.g)(),c=function(e){t.push("".concat(e))};return null!==e.token?Object(h.jsx)(l.a,{to:"/profile"}):Object(h.jsxs)("div",{className:"container-fluid main",children:[Object(h.jsxs)("div",{className:"text-center align-middle",children:[Object(h.jsx)("h1",{id:"welcome-title",children:"Prosfero"}),Object(h.jsx)("p",{id:"welcome-slogan",children:"Giving made easy"})]}),Object(h.jsxs)("div",{className:"text-center",children:[Object(h.jsx)("button",{type:"button",className:"btn btn-outline-primary btn-lng welcome-button",onClick:function(){return c("/registration")},children:"REGISTER"}),Object(h.jsx)("button",{type:"button",className:"btn btn-outline-success btn-lng welcome-button",onClick:function(){return c("/login")},children:"LOGIN"})]})]})},S=function(){return Object(h.jsx)(l.a,{to:"/welcome"})},w=(c(35),new(c(78).a)({params:{countrycodes:"sg"}})),C=function(e){return w.search({query:"".concat(e)})},F=c(83),I=c(79),D=function(e){var t=e.defaultValue,c=e.loading,a=e.suggestions,s=e.menuIsOpen,r=e.requests,i=e.placeholder,l=e.onSelect,j=Object(n.useState)(""),d=Object(o.a)(j,2),u=d[0],b=d[1],m=Object(n.useCallback)(Object(I.debounce)((function(e){return r(e)}),1e3),[]),O=a.map((function(e){return{value:e.label,label:e.label,lon:e.x,lat:e.y}}));return Object(h.jsx)(h.Fragment,{children:Object(h.jsx)(F.a,{value:t,inputValue:u,onInputChange:function(e){return b(t=e),void m(t);var t},onChange:function(e){return l(e)},isLoading:c,loadingMessage:function(){return"Loading options"},menuIsOpen:s,placeholder:i,options:O})})},U=function(){var e=Object(n.useContext)(p),t=e.user,c=e.setUser,a=Object(l.g)(),s=Object(n.useState)({file:null}),r=Object(o.a)(s,2),i=r[0],j=r[1],b=Object(n.useState)({title:"",category:"",description:"",image:""}),x=Object(o.a)(b,2),f=x[0],v=x[1],N=Object(n.useState)([]),y=Object(o.a)(N,2),k=y[0],S=y[1],w=Object(n.useState)(!1),F=Object(o.a)(w,2),I=F[0],U=F[1],P=Object(n.useState)(!1),A=Object(o.a)(P,2),E=A[0],R=A[1],q=Object(n.useState)({label:"",lon:"",lat:""}),B=Object(o.a)(q,2),z=B[0],L=B[1],T=function(){var e=Object(u.a)(d.a.mark((function e(t){var c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=10;break}return U(!0),e.next=4,C(t);case 4:c=e.sent,S(c),U(!1),R(!0),e.next=12;break;case 10:S([]),R(!1);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(u.a)(d.a.mark((function e(t){var c,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),null!==i.file||void 0!==i.file?(c=i.file,(n=new FormData).append("file",c),n.append("upload_preset","prosfero"),m.a.post("https://api.cloudinary.com/v1_1/drv2gra8s/image/upload",n).then((function(e){var t=e.data,c=Object(g.a)({},f);c.image=t.secure_url,v(c)})).catch((function(e){console.log(e),alert(e)}))):alert("Please select an Image");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(e){var t=Object(g.a)({},f);t[e.target.name]=e.target.value,v(t)};return!t.token||t.expired?Object(h.jsx)(l.a,{to:"/login"}):Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(O,{loggedin:!0,func:function(){localStorage.removeItem("prosfero-token"),localStorage.removeItem("prosfero-id"),c({token:null,id:null})}}),Object(h.jsx)("div",{className:"form-pad",children:Object(h.jsxs)("form",{className:"form-post",children:[Object(h.jsx)("div",{className:"text-center",children:Object(h.jsx)("h1",{style:{fontFamily:"Dancing Script"},children:"Create Your Post"})}),Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("label",{htmlFor:"title",className:"form-label",children:"Title"}),Object(h.jsx)("input",{type:"text",className:"form-control",autoComplete:"off",id:"title",name:"title",onChange:function(e){return Y(e)},value:f.title,placeholder:"Enter the title of your post"})]}),Object(h.jsx)("div",{className:"mb-3",children:Object(h.jsxs)("select",{className:"form-select",name:"category",value:f.category,onChange:function(e){return Y(e)},"aria-label":"choose chatergory",children:[Object(h.jsx)("option",{value:"",defaultValue:!0,disabled:!0,children:"Choose category"}),Object(h.jsx)("option",{value:"Food",children:"Food"}),Object(h.jsx)("option",{value:"Electronics",children:"Electronics"}),Object(h.jsx)("option",{value:"Stationary",children:"Stationary"}),Object(h.jsx)("option",{value:"Furniture",children:"Furniture"}),Object(h.jsx)("option",{value:"Other",children:"Other"})]})}),Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("label",{htmlFor:"description",className:"form-label",children:"Location"}),Object(h.jsx)(D,{loading:I,requests:T,suggestions:k,menuIsOpen:E,onSelect:function(e){L(e)},placeholder:"Please type in a location"})]}),Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("label",{htmlFor:"description",className:"form-label",children:"Descripton of Item"}),Object(h.jsx)("textarea",{className:"form-control",id:"description",rows:"3",name:"description",onChange:function(e){return Y(e)},value:f.description})]}),Object(h.jsxs)("div",{className:"input-group mb-3",children:[Object(h.jsx)("input",{type:"file",className:"form-control",name:"image",onChange:function(e){return function(e){j({file:e.target.files[0]})}(e)},id:"image"}),Object(h.jsx)("button",{className:"input-group-text",htmlFor:"image",onClick:function(e){return _(e)},children:"Upload"})]}),f.image&&Object(h.jsx)("div",{className:"text-center",children:Object(h.jsx)("img",{src:f.image,className:"img-thumbnail",alt:""})}),Object(h.jsx)("div",{className:"text-center",children:Object(h.jsx)("button",{type:"submit",className:"btn btn-primary",onClick:function(e){return function(e){e.preventDefault(),m.a.post("http://localhost:5000/api/v1/posts",{title:f.title,desc:f.description,category:f.category,image:f.image,location:{label:z.label,lon:z.lon,lat:z.lat}},{headers:{Authorization:"Bearer ".concat(t.token)}}).then((function(e){alert("Post submitted!"),a.push("/post/".concat(e.data.id))})).catch((function(e){return alert(e)}))}(e)},children:"Submit"})})]})})]})},P=c(9),A=(c(64),function(e){var t,c=e.post,n=e.index;return Object(h.jsx)("div",{className:"col col-xl-3 col-lg-4 col-md-6 col-sm-12",children:Object(h.jsxs)("div",{className:"card h-100",children:[Object(h.jsx)(i.b,{to:"/post/".concat(c.id),children:Object(h.jsx)("img",{src:c.image,alt:c.id,className:"card-img-top crop",style:{maxHeight:"15rem"}})}),Object(h.jsxs)("div",{className:"card-body",children:[Object(h.jsx)(i.b,{to:"/post/".concat(c.id),style:{textDecoration:"none",color:"black"},children:Object(h.jsx)("h5",{className:"card-title",children:c.title})}),Object(h.jsx)("small",{className:"text-muted",children:c.category}),Object(h.jsx)("hr",{}),Object(h.jsx)("p",{className:"card-text",children:c.desc})]}),Object(h.jsxs)("div",{className:"card-footer",children:[Object(h.jsx)("small",{children:c.username}),Object(h.jsx)("br",{}),Object(h.jsx)("small",{className:"text-muted",children:new Date(c.createdAt).toUTCString()}),Object(h.jsx)("hr",{}),Object(h.jsx)("small",{children:null===(t=c.location)||void 0===t?void 0:t.label})]})]})},n)}),E=[{_id:"1",name:"Food"},{_id:"2",name:"Electronics"},{_id:"3",name:"Stationary"},{_id:"4",name:"Furniture"},{_id:"5",name:"Other"}],R=function(e){var t=e.handleFilters,c=e.handleOrder,a=e.customStyle,s=Object(n.useState)([]),r=Object(o.a)(s,2),i=r[0],l=r[1],j=Object(n.useState)({value:"1",id:"latest"}),d=Object(o.a)(j,2),u=d[0],b=d[1],m=function(e){var t={value:e.target.value,id:e.target.id};b(t),c(t)};return Object(h.jsxs)("div",{style:a,children:[Object(h.jsx)("button",{className:"btn btn-primary",type:"button","data-bs-toggle":"collapse","data-bs-target":"#filter","aria-expanded":"false","aria-controls":"filter",style:{marginBottom:"1rem"},children:"Filter & Sort"}),Object(h.jsx)("div",{className:"collapse",id:"filter",style:{marginBottom:"1rem"},children:Object(h.jsxs)("div",{className:"row",children:[Object(h.jsx)("div",{className:"col",children:Object(h.jsxs)("div",{className:"card",children:[Object(h.jsx)("div",{className:"card-header",children:"Filter by Category"}),Object(h.jsx)("div",{className:"card-body",children:E.map((function(e){return Object(h.jsxs)("div",{className:"form-check form-check-inline",children:[Object(h.jsx)("input",{className:"form-check-input ",type:"checkbox",id:e._id,checked:i.includes(e.name),onChange:function(){return function(e){var c=i.indexOf(e),n=Object(P.a)(i);-1===c?n.push(e):n.splice(c,1),l(n),t(n)}(e.name)}}),Object(h.jsx)("label",{className:"form-check-label",htmlFor:e._id,children:e.name})]},e._id)}))})]})}),Object(h.jsx)("div",{className:"col-6",children:Object(h.jsxs)("div",{className:"card",s:!0,children:[Object(h.jsx)("div",{className:"card-header",children:"Sort Posts"}),Object(h.jsx)("div",{className:"card-body text-center",style:{paddingBottom:"0rem"},children:Object(h.jsxs)("div",{className:"btn-group",role:"group",style:{margin:"0rem",padding:"0rem"},children:[Object(h.jsx)("input",{type:"radio",className:"btn-check",name:"btnradio",id:"latest",autocomplete:"off",value:"1",checked:"1"===u.value,onChange:m}),Object(h.jsx)("label",{className:"btn btn-outline-primary",for:"latest",children:"Latest Posts first"}),Object(h.jsx)("input",{type:"radio",className:"btn-check",name:"btnradio",id:"oldest",value:"-1",autocomplete:"off",checked:"-1"===u.value,onChange:m}),Object(h.jsx)("label",{className:"btn btn-outline-primary",for:"oldest",children:"Oldest Posts first"})]})})]})})]})})]})},q=function(){var e=Object(n.useContext)(p),t=e.user,c=e.setUser,a=Object(n.useState)(!0),s=Object(o.a)(a,2),r=s[0],i=s[1],j=Object(n.useState)(!1),d=Object(o.a)(j,2),u=d[0],b=d[1],x=Object(n.useState)([]),f=Object(o.a)(x,2),v=f[0],g=f[1],N=Object(n.useState)(0),y=Object(o.a)(N,2),k=y[0],S=y[1],w=Object(n.useState)(null),C=Object(o.a)(w,2),F=C[0],I=C[1],D=Object(n.useState)([]),U=Object(o.a)(D,2),E=U[0],q=U[1],B=Object(n.useState)([]),z=Object(o.a)(B,2),L=z[0],T=z[1],_=Object(n.useState)({value:"1",id:"latest"}),Y=Object(o.a)(_,2),W=Y[0],M=Y[1],V=function(){m.a.create({baseURL:"http://localhost:5000/api/v1/posts",headers:{Authorization:"Bearer ".concat(t.token)}}).get("/limited/".concat(8,"/").concat(k),{params:{order:parseInt(W.value)}}).then((function(e){e.data.length<8&&i(!1),g([].concat(Object(P.a)(v),Object(P.a)(e.data))),S(k+8),b(!1),H(E)})).catch((function(e){return alert(e)}))},J=Object(n.useRef)(V),G=Object(n.useRef)(new IntersectionObserver((function(e){e[0].isIntersecting&&(b(!0),J.current())}),{rootMargin:"50px",threshold:.25}));Object(n.useEffect)((function(){J.current=V}),[V]),Object(n.useEffect)((function(){var e=F,t=G.current;return e&&t.observe(e),function(){e&&t.unobserve(e)}}),[F]);var H=function(e){e.length>0?T(v.filter((function(t){return e.includes(t.category)}))):T(v)};return!t.token||t.expired?Object(h.jsx)(l.a,{to:"/login"}):Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(O,{loggedin:!0,func:function(){localStorage.removeItem("prosfero-token"),localStorage.removeItem("prosfero-id"),c({token:null,id:null})}}),Object(h.jsxs)("div",{className:"container",style:{marginTop:"1rem"},children:[Object(h.jsx)("div",{className:"title text-center",style:{fontFamily:"Dancing Script",fontWeight:"bold"},children:Object(h.jsx)("h1",{children:"Listings"})}),Object(h.jsx)("div",{className:"filter",children:Object(h.jsx)(R,{handleFilters:function(e){return function(e){var t=e;H(t),q(t)}(e)},handleOrder:function(e){e.value!==M.value&&(M(e),b(!1),i(!0),S(0),g([]),T([]))},customStyle:0===L.length?{display:"none"}:{}})}),Object(h.jsxs)("div",{className:"col row row-cols-1 row-cols-sm-2 row-cols-md-4 g-4",id:"post-container",children:[L.length>0&&L.map((function(e,t){return Object(h.jsx)(A,{post:e,index:t})})),!u&&r?Object(h.jsx)("div",{ref:I,style:{padding:"2rem"}}):Object(h.jsx)("div",{id:"footer",style:{padding:"1rem"},children:" "})]})]})]})},B=(c(127),function(){var e,t=Object(n.useContext)(p),c=t.user,a=t.setUser,s=Object(l.g)(),r=Object(l.h)().postId,j=Object(n.useState)({text:""}),d=Object(o.a)(j,2),u=d[0],b=d[1],x="http://localhost:5000/api/v1/posts/requests/".concat(r),f=Object(n.useState)(!1),v=Object(o.a)(f,2),N=v[0],y=v[1],k="http://localhost:5000/api/v1/posts/single/".concat(r);return Object(n.useEffect)((function(){m.a.get(k,{headers:{Authorization:"Bearer ".concat(c.token)}}).then((function(e){console.log(e.data),b(e.data)})).catch((function(e){alert(e),s.push("/home")}))}),[]),!c.token||c.expired?Object(h.jsx)(l.a,{to:"/login"}):Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(O,{loggedin:!0,func:function(){localStorage.removeItem("prosfero-token"),localStorage.removeItem("prosfero-id"),a({token:null,id:null})}}),Object(h.jsx)("div",{className:"post",children:Object(h.jsx)("div",{className:"container",children:Object(h.jsxs)("div",{className:"row",children:[Object(h.jsx)("div",{className:"col content",children:Object(h.jsx)("div",{className:"text-center",children:Object(h.jsx)("img",{src:u.image,style:{maxWidth:"20rem",maxHeight:"20rem"},className:"img-thumbnail",alt:u.title})})}),Object(h.jsxs)("div",{className:"col info-box",children:[Object(h.jsx)("h1",{style:{fontWeight:"bold",marginBottom:"1rem"},children:u.title}),Object(h.jsxs)("h5",{children:["Posted by: ",u.username]}),Object(h.jsx)("hr",{}),Object(h.jsx)("p",{children:u.desc}),Object(h.jsxs)("p",{children:[Object(h.jsx)("strong",{children:"Location:"})," ",Object(h.jsx)("br",{}),null===(e=u.location)||void 0===e?void 0:e.label]}),Object(h.jsx)("hr",{}),Object(h.jsxs)("p",{children:["Category: ",u.category]}),Object(h.jsxs)("p",{children:["Created at: ",new Date(u.createdAt).toUTCString()]}),Object(h.jsxs)("div",{className:"text-center",children:[console.log(c.id,u.userid),u.userid===c.id?Object(h.jsx)(i.b,{class:"btn btn-primary",to:"/editpost/".concat(r),children:"Edit"}):Object(h.jsx)("div",{class:"btn btn-primary",onClick:function(){return y(!N)},children:"Request"}),N&&Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("label",{htmlFor:"text",className:"form-label",children:"Text"}),Object(h.jsx)("input",{type:"text",className:"form-control",id:"text",name:"text",autoComplete:"off",onChange:function(e){return function(e){var t=Object(g.a)({},u);t[e.target.name]=e.target.value,b(t)}(e)},value:u.text,placeholder:"(Optional) Enter request text"}),Object(h.jsx)("div",{className:"text-center"}),Object(h.jsx)("button",{type:"submit",className:"btn btn-primary",onClick:function(e){return function(e){e.preventDefault(),m.a.post(x,{text:u.text},{headers:{Authorization:"Bearer ".concat(c.token)}}).then((function(e){alert("Request submitted!")})).catch((function(e){e.response&&alert(e.response.data),console.log(e)}))}(e)},children:"Submit"})]})]})]})]})})})]})}),z=function(){var e=Object(l.h)().postId,t="http://localhost:5000/api/v1/posts/single/".concat(e),c="http://localhost:5000/api/v1/posts/".concat(e),a=Object(n.useState)(""),s=Object(o.a)(a,2),r=s[0],i=s[1],j=Object(n.useState)([]),b=Object(o.a)(j,2),x=b[0],f=b[1],v=Object(n.useState)(!1),N=Object(o.a)(v,2),y=N[0],k=N[1],S=Object(n.useState)(!1),w=Object(o.a)(S,2),F=w[0],I=w[1],U=function(){var e=Object(u.a)(d.a.mark((function e(t){var c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=10;break}return k(!0),e.next=4,C(t);case 4:c=e.sent,f(c),k(!1),I(!0),e.next=12;break;case 10:f([]),I(!1);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){m.a.get(t,{headers:{Authorization:"Bearer ".concat(A.token)}}).then((function(e){e.data.userid!==A.id&&(alert("Unathorized"),R.push("/home")),i(e.data)})).catch((function(e){console.log(e),alert(e),R.push("/home")}))}),[]);var P=Object(n.useContext)(p),A=P.user,E=P.setUser,R=Object(l.g)(),q=Object(n.useState)({file:null}),B=Object(o.a)(q,2),z=B[0],L=B[1],T=function(){var e=Object(u.a)(d.a.mark((function e(t){var c,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),null!==z.file||void 0!==z.file?(c=z.file,(n=new FormData).append("file",c),n.append("upload_preset","prosfero"),m.a.post("https://api.cloudinary.com/v1_1/drv2gra8s/image/upload",n).then((function(e){var t=e.data,c=Object(g.a)({},r);c.image=t.secure_url,i(c)})).catch((function(e){console.log(e),alert(e)}))):alert("Please select an Image");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(e){var t=Object(g.a)({},r);t[e.target.name]=e.target.value,i(t)};return!A.token||A.expired?Object(h.jsx)(l.a,{to:"/login"}):Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(O,{loggedin:!0,func:function(){localStorage.removeItem("prosfero-token"),localStorage.removeItem("prosfero-id"),E({token:null,id:null})}}),Object(h.jsx)("div",{className:"form-pad",children:Object(h.jsxs)("form",{className:"form-post",children:[Object(h.jsx)("div",{className:"text-center",children:Object(h.jsx)("h1",{style:{fontFamily:"Dancing Script"},children:"Edit Post"})}),Object(h.jsxs)("h3",{children:["Title: ",r.title]}),Object(h.jsx)("div",{className:"mb-3",children:Object(h.jsxs)("select",{className:"form-select",name:"category",value:r.category,onChange:function(e){return _(e)},"aria-label":"choose chatergory",children:[Object(h.jsx)("option",{value:"",disabled:!0,children:"Choose category"}),Object(h.jsx)("option",{value:"Food",children:"Food"}),Object(h.jsx)("option",{value:"Electronics",children:"Electronics"}),Object(h.jsx)("option",{value:"Stationary",children:"Stationary"}),Object(h.jsx)("option",{value:"Furniture",children:"Furniture"}),Object(h.jsx)("option",{value:"Other",children:"Other"})]})}),Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("label",{htmlFor:"description",className:"form-label",children:"Location"}),Object(h.jsx)(D,{defaultValue:r.location,loading:y,requests:U,suggestions:x,menuIsOpen:F,onSelect:function(e){var t=Object(g.a)({},r);t.location={label:e.label,lon:e.lon,lan:e.lan},i(t)},placeholder:"Please type in a location"})]}),Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("label",{htmlFor:"description",className:"form-label",children:"Descripton of Item"}),Object(h.jsx)("textarea",{className:"form-control",id:"description",rows:"3",name:"desc",onChange:function(e){return _(e)},value:r.desc})]}),Object(h.jsxs)("div",{className:"input-group mb-3",children:[Object(h.jsx)("input",{type:"file",className:"form-control",name:"image",onChange:function(e){return function(e){L({file:e.target.files[0]})}(e)},id:"image"}),Object(h.jsx)("button",{className:"input-group-text",htmlFor:"image",onClick:function(e){return T(e)},children:"Upload"})]}),r.image&&Object(h.jsx)("div",{className:"text-center",children:Object(h.jsx)("img",{src:r.image,className:"img-thumbnail",alt:r.title})}),Object(h.jsx)("div",{className:"text-center",children:Object(h.jsx)("button",{type:"submit",className:"btn btn-primary",onClick:function(t){return function(t){t.preventDefault(),m.a.put(c,{title:r.title,desc:r.desc,category:r.category,image:r.image,location:r.location},{headers:{Authorization:"Bearer ".concat(A.token)}}).then((function(t){alert("Post updated!"),R.push("/post/".concat(e))})).catch((function(e){return alert(e)}))}(t)},children:"Update"})})]})})]})},L=function(){var e=Object(n.useContext)(p),t=e.user,c=e.setUser,a=Object(n.useState)(!0),s=Object(o.a)(a,2),r=s[0],i=s[1],j=Object(n.useState)(!1),d=Object(o.a)(j,2),u=d[0],b=d[1],x=Object(n.useState)([]),f=Object(o.a)(x,2),v=f[0],g=f[1],N=Object(n.useState)(0),y=Object(o.a)(N,2),k=y[0],S=y[1],w=Object(n.useState)(null),C=Object(o.a)(w,2),F=C[0],I=C[1],D=Object(n.useState)([]),U=Object(o.a)(D,2),E=U[0],q=U[1],B=Object(n.useState)([]),z=Object(o.a)(B,2),L=z[0],T=z[1],_=Object(n.useState)({value:"1",id:"latest"}),Y=Object(o.a)(_,2),W=Y[0],M=Y[1],V=new URLSearchParams(document.location.search.substring(1)).get("q"),J=function(){m.a.create({baseURL:"http://localhost:5000/api/v1/posts",headers:{Authorization:"Bearer ".concat(t.token)}}).get("/filter",{params:{q:V,limit:8,skip:k,order:parseInt(W.value)}}).then((function(e){e.data.length<8&&(console.log(e.data),i(!1));var t=[].concat(Object(P.a)(v),Object(P.a)(e.data));g(t),S(k+8),b(!1),K(E,t)})).catch((function(e){return alert(e)}))},G=Object(n.useRef)(J),H=Object(n.useRef)(new IntersectionObserver((function(e){e[0].isIntersecting&&(b(!0),G.current())}),{rootMargin:"50px",threshold:.25}));if(Object(n.useEffect)((function(){g([]),T([]),S(0),i(!0),b(!1)}),[V]),Object(n.useEffect)((function(){G.current=J}),[J]),Object(n.useEffect)((function(){var e=F,t=H.current;return e&&t.observe(e),function(){e&&t.unobserve(e)}}),[F]),!t.token||t.expired)return Object(h.jsx)(l.a,{to:"/login"});var K=function(e,t){e.length>0?T(t.filter((function(t){return e.includes(t.category)}))):T(t)};return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(O,{loggedin:!0,func:function(){localStorage.removeItem("prosfero-token"),localStorage.removeItem("prosfero-id"),c({token:null,id:null})}}),Object(h.jsxs)("div",{className:"container",style:{marginTop:"1rem"},children:[Object(h.jsx)("div",{style:{fontWeight:"bold",paddingBottom:"1rem"},children:Object(h.jsxs)("h2",{children:['Search Results for "',V,'"']})}),Object(h.jsx)("div",{className:"filter",children:Object(h.jsx)(R,{handleFilters:function(e){return function(e){var t=e;K(t,v),q(t)}(e)},handleOrder:function(e){e.value!==M.value&&(M(e),S(0),g([]),T([]),b(!1),i(!0))},customStyle:0===L.length?{display:"none"}:{}})}),L.length>0?Object(h.jsx)(h.Fragment,{children:Object(h.jsx)("div",{className:"row row-cols-1 row-cols-sm-2 row-cols-md-4 g-4",id:"post-container",children:L.map((function(e,t){return Object(h.jsx)(A,{post:e,index:t})}))})}):'Your search "'.concat(V,'" did not match any listings.'),!u&&r?Object(h.jsx)("div",{ref:I,style:{padding:"2rem"}}):Object(h.jsx)("div",{id:"footer",style:{padding:"1rem"},children:" "})]})]})},T=(c(128),function(e){var t=e.conversation,c=e.currentUser,a=e.onCustomClick,s=Object(n.useState)(null),r=Object(o.a)(s,2),i=r[0],l=r[1];return Object(n.useEffect)((function(){var e=t.members.find((function(e){return e!==c.id}));(function(){var t=Object(u.a)(d.a.mark((function t(){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,m.a.get("http://localhost:5000/api/v1/profile/data/".concat(e),{headers:{Authorization:"Bearer ".concat(c.token)}});case 3:n=t.sent,l(n.data),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}})()()}),[c,t]),Object(h.jsxs)("div",{className:"conversation",onClick:function(){return a(i.username)},children:[(null===i||void 0===i?void 0:i.profilePicture)?Object(h.jsx)("img",{className:"conversationImg",src:i.profilePicture,alt:""}):Object(h.jsx)(f.a,{className:"conversationImg"}),Object(h.jsx)("span",{className:"conversationName",children:null===i||void 0===i?void 0:i.username})]})}),_=c(84),Y=(c(129),function(e){var t=e.message,c=e.own;return Object(h.jsxs)("div",{className:c?"message own":"message",children:[Object(h.jsx)("div",{className:"message-cover",children:Object(h.jsx)("div",{className:"message-text",children:t.text})}),Object(h.jsx)("div",{className:"message-meta",children:Object(_.a)(t.createdAt)})]})}),W=c(80),M=c(82),V=c.n(M),J=c(81),G=c.n(J),H=(c(154),function(){var e=Object(n.useContext)(p),t=e.user,c=e.setUser,a=Object(n.useState)([]),s=Object(o.a)(a,2),r=s[0],i=s[1],j=Object(n.useState)(null),b=Object(o.a)(j,2),x=b[0],f=b[1],v=Object(n.useState)([]),g=Object(o.a)(v,2),N=g[0],y=g[1],k=Object(n.useState)(""),S=Object(o.a)(k,2),w=S[0],C=S[1],F=Object(n.useState)(null),I=Object(o.a)(F,2),D=I[0],U=I[1],A=Object(n.useRef)(),E=Object(n.useState)(""),R=Object(o.a)(E,2),q=R[0],B=R[1],z=Object(n.useState)(!0),L=Object(o.a)(z,2),_=L[0],M=L[1],J=Object(n.useRef)();Object(n.useEffect)((function(){window.addEventListener("resize",(function(){window.innerWidth>992?M(!0):M(!1)}))}),[]),Object(n.useEffect)((function(){J.current=Object(W.io)("ws://localhost:8900"),J.current.on("getMessage",(function(e){U({sender:e.senderId,text:e.text,createdAt:Date.now()})}))}),[]),Object(n.useEffect)((function(){D&&(null===x||void 0===x?void 0:x.members.includes(D.sender))&&y((function(e){return[].concat(Object(P.a)(e),[D])}))}),[D]),Object(n.useEffect)((function(){J.current.emit("addUser",t.id)}),[t]),Object(n.useEffect)((function(){(function(){var e=Object(u.a)(d.a.mark((function e(){var c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.a.get("http://localhost:5000/api/v1/conversations/".concat(t.id),{headers:{Authorization:"Bearer ".concat(t.token)}});case 3:c=e.sent,i(c.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()()}),[t.id]),Object(n.useEffect)((function(){(function(){var e=Object(u.a)(d.a.mark((function e(){var c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.a.get("http://localhost:5000/api/v1/messages/".concat(null===x||void 0===x?void 0:x._id),{headers:{Authorization:"Bearer ".concat(t.token)}});case 3:c=e.sent,y(c.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()()}),[x]);var H=function(){var e=Object(u.a)(d.a.mark((function e(c){var n,a,s,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.preventDefault(),n={sender:t.id,text:w,conversationId:x._id},a=x.members.find((function(e){return e!==t.id})),J.current.emit("sendMessage",{senderId:t.id,recieverId:a,text:w}),e.prev=4,s=m.a.create({baseURL:"http://localhost:5000/api/v1/messages",headers:{Authorization:"Bearer ".concat(t.token)}}),e.next=8,s.post("",n);case 8:r=e.sent,y([].concat(Object(P.a)(N),[r.data])),C(""),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(4),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){var e;null===(e=A.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[N]),!t.token||t.expired?Object(h.jsx)(l.a,{to:"/login"}):Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(O,{loggedin:!0,func:function(){localStorage.removeItem("prosfero-token"),localStorage.removeItem("prosfero-id"),c({token:null,id:null})}}),Object(h.jsx)("div",{className:"container",style:{margin:"auto",padding:"1rem"},children:Object(h.jsxs)("div",{className:"chat row",children:[Object(h.jsxs)("div",{className:"col-lg-3 xcxcsidebar",style:{backgroundColor:"#e6f5ff",borderRadius:"1rem",padding:"1rem"},children:[Object(h.jsx)("div",{className:"container",children:Object(h.jsxs)("div",{className:"row",children:[Object(h.jsx)("div",{className:"col",children:Object(h.jsx)("h3",{children:"Conversations"})}),_?Object(h.jsx)("div",{className:"col-3 toggle-wrapper",children:Object(h.jsx)(G.a,{className:"chat-toggle",onClick:function(){return M((function(e){return!e}))}})}):Object(h.jsx)("div",{className:"col-3 toggle-wrapper",children:Object(h.jsx)(V.a,{className:"chat-toggle",onClick:function(){return M((function(e){return!e}))}})})]})}),Object(h.jsx)("hr",{}),Object(h.jsx)("div",{className:"toggleConversation",style:{display:!_&&"none"},children:r.map((function(e){return Object(h.jsx)("div",{onClick:function(){f(e)},children:Object(h.jsx)(T,{conversation:e,currentUser:t,onCustomClick:function(e){return B(e)}})},e._id)}))})]}),Object(h.jsxs)("div",{className:"col cxcxchatbox",children:[""!==q&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("h3",{style:{paddingTop:"1rem"},children:q}),Object(h.jsx)("hr",{})]}),Object(h.jsx)("div",{className:"chatbox-wrapper",children:x?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("div",{className:"chat-window",children:[0===N.length&&Object(h.jsx)("div",{className:"text-center",style:{marginTop:"2rem"},children:Object(h.jsx)("span",{className:"text-muted",children:"No messages yet"})}),N.map((function(e){return Object(h.jsx)("div",{ref:A,children:Object(h.jsx)(Y,{message:e,own:e.sender===t.id})},e._id)}))]}),Object(h.jsxs)("div",{className:"chat-input",children:[Object(h.jsx)("textarea",{className:"chat-input-textarea",rows:"3",value:w,onChange:function(e){return C(e.target.value)}}),Object(h.jsx)("div",{className:"button-wrapper",children:Object(h.jsx)("button",{className:"chat-input-button btn btn-primary",onClick:H,children:"Send"})})]})]}):Object(h.jsx)("div",{className:"text-center",style:{fontSize:"3rem",color:"lightgrey",marginTop:"6rem",height:"65vh"},children:Object(h.jsx)("span",{children:"Open a conversation to start a chart"})})})]})]})})]})}),K=function(){var e=Object(n.useState)([""]),t=Object(o.a)(e,2),c=t[0],a=t[1],s=Object(n.useContext)(p),r=s.user,i=s.setUser,j=Object(l.g)();if(Object(n.useEffect)((function(){null!==r.token&&m.a.create({baseURL:"http://localhost:5000/api/v1/requests",headers:{Authorization:"Bearer ".concat(r.token)}}).post("",{headers:{Authorization:"Bearer ".concat(r.token)}}).then((function(e){a(e.data),console.log("requests: ",e)})).catch((function(e){return alert(e)}))}),[]),!r.token||r.expired)return Object(h.jsx)(l.a,{to:"/login"});var d=function(e){return console.log(e),"approved"===e[3]?Object(h.jsxs)("div",{className:"card h-100",children:[Object(h.jsxs)("div",{className:"card-body",children:["Your request on ",Object(h.jsx)("b",{children:e[0]})," has been accepted!",Object(h.jsx)("br",{})," Contact them at ",Object(h.jsx)("b",{children:e[4]}),Object(h.jsx)("br",{}),Object(h.jsx)("br",{}),Object(h.jsx)("button",{className:"btn btn-primary",onClick:function(){return t=e[7],void m.a.create({baseURL:"http://localhost:5000/api/v1",headers:{Authorization:"Bearer ".concat(r.token)}}).post("/conversations",{senderId:r.id,receiverId:t}).then((function(e){j.push("/chat")})).catch((function(e){return alert(e)}));var t},children:"Start Conversation"}),Object(h.jsxs)("div",{class:"p-3 border bg-light",children:[Object(h.jsxs)("i",{children:[" Request made on ",new Date(e[1]).toUTCString()]}),Object(h.jsx)("br",{}),"You said:",Object(h.jsx)("br",{}),e[2]]})]}),"Were you able to receive the item?",Object(h.jsx)("br",{})," ",Object(h.jsx)("br",{}),Object(h.jsx)("a",{href:"#",class:"btn btn-outline-success",onClick:function(t){return function(e,t){e.preventDefault(),m.a.create({baseURL:"http://localhost:5000/api/v1",headers:{Authorization:"Bearer ".concat(r.token)}}).post("/requests/success/".concat(t[5])).then(alert("Congatulations!"))}(t,e)},children:"Able"}),Object(h.jsx)("a",{href:"#",class:"btn btn-outline-danger",onClick:function(t){return function(e,t){e.preventDefault(),m.a.create({baseURL:"http://localhost:5000/api/v1",headers:{Authorization:"Bearer ".concat(r.token)}}).post("/requests/fail/".concat(t[6])).then(alert("Oh wells :("))}(t,e)},children:"Unable"})]}):"declined"!==e[3]?Object(h.jsx)("div",{class:"col",children:Object(h.jsxs)("div",{class:"p-3 border bg-light",children:["You requested ",Object(h.jsx)("b",{children:e[0]})," ",Object(h.jsx)("br",{}),Object(h.jsxs)("i",{children:[" On ",new Date(e[1]).toUTCString()]}),Object(h.jsx)("br",{}),"You said:",Object(h.jsx)("br",{}),e[2]]})}):void 0};return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(O,{loggedin:!0,func:function(){localStorage.removeItem("prosfero-token"),localStorage.removeItem("prosfero-id"),i({token:null,id:null})}}),Object(h.jsxs)("div",{className:"container profile",style:{marginTop:"1rem"},children:[Object(h.jsx)("div",{className:"text-center",style:{fontFamily:"Dancing Script"},children:Object(h.jsx)("h2",{children:"Requests You Made"})}),Object(h.jsx)("div",{class:"container px-4",children:Object(h.jsx)("div",{class:"row row-cols-1 row-cols-sm-2 row-cols-md-3 g-4 gx-5",children:c&&c.map((function(e){return d(e)}))})})]})]})},Q=function(){var e=Object(n.useState)({username:"",category:""}),t=Object(o.a)(e,2),c=t[0],a=t[1],s=Object(n.useContext)(p),r=s.user,i=s.setUser,l="http://localhost:5000/api/v1/telebots",j=function(e){var t=Object(g.a)({},c);t[e.target.name]=e.target.value,a(t)};return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(O,{loggedin:!0,func:function(){localStorage.removeItem("prosfero-token"),localStorage.removeItem("prosfero-id"),i({token:null,id:null})}}),Object(h.jsx)("div",{className:"form-pad",children:Object(h.jsxs)("form",{className:"form-post",children:[Object(h.jsx)("div",{className:"text-center",children:Object(h.jsx)("h1",{style:{fontFamily:"Dancing Script"},children:"Set up your telebot!"})}),Object(h.jsx)("div",{className:"text-left",children:Object(h.jsx)("h8",{children:"You can set up your Telegram bot extension and recieve notifications whenever a new item is posted!"})}),Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("h8",{children:"Enter the Telegram username you want to connect your Prosfero account with."}),Object(h.jsx)("br",{}),Object(h.jsx)("br",{}),Object(h.jsx)("label",{htmlFor:"title",className:"form-label",children:"Telegram Username"}),Object(h.jsx)("input",{type:"text",className:"form-control",id:"username",name:"username",onChange:function(e){return j(e)},value:c.username,placeholder:"Enter Telegram username"})]}),Object(h.jsx)("div",{className:"text-center",children:Object(h.jsx)("button",{type:"submit",className:"btn btn-primary",onClick:function(e){return function(e){e.preventDefault(),m.a.post(l,{username:c.username},{headers:{Authorization:"Bearer ".concat(r.token)}}).then((function(e){alert("Telegram Username Registered!")})).catch((function(e){return alert(e)}))}(e)},children:"Submit"})})]})}),Object(h.jsx)("br",{}),Object(h.jsx)("div",{className:"form-pad",children:Object(h.jsxs)("form",{className:"form-post",children:[Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsxs)("h8",{children:["Add a category to your ",Object(h.jsx)("i",{children:"Interested"}),Object(h.jsx)("br",{}),"You will then recieve a notification whenever an item is posted in that category!"]}),Object(h.jsx)("br",{}),Object(h.jsx)("br",{}),Object(h.jsxs)("select",{className:"form-select",name:"category",value:c.category,onChange:function(e){return j(e)},"aria-label":"choose chatergory",children:[Object(h.jsx)("option",{value:"",defaultValue:!0,disabled:!0,children:"Choose category"}),Object(h.jsx)("option",{value:"Food",children:"Food"}),Object(h.jsx)("option",{value:"Electronics",children:"Electronics"}),Object(h.jsx)("option",{value:"Stationary",children:"Stationary"}),Object(h.jsx)("option",{value:"Furniture",children:"Furniture"})]})]}),Object(h.jsx)("div",{className:"text-center",children:Object(h.jsx)("button",{type:"submit",className:"btn btn-primary",onClick:function(e){return function(e){e.preventDefault(),m.a.put(l,{category:c.category},{headers:{Authorization:"Bearer ".concat(r.token)}}).then((function(e){alert(e.data)})).catch((function(e){return alert(e)}))}(e)},children:"Submit"})})]})})]})};var X=function(){var e=Object(n.useState)({token:localStorage.getItem("prosfero-token"),id:localStorage.getItem("prosfero-id")}),t=Object(o.a)(e,2),c=t[0],a=t[1],s=Object(n.useMemo)((function(){return{user:c,setUser:a}}),[c,a]);return Object(h.jsx)(p.Provider,{value:s,children:Object(h.jsx)(i.a,{children:Object(h.jsxs)(l.d,{children:[Object(h.jsx)(l.b,{path:"/login",exact:!0,component:N}),Object(h.jsx)(l.b,{path:"/profile",exact:!0,component:v}),Object(h.jsx)(l.b,{path:"/registration",exact:!0,component:y}),Object(h.jsx)(l.b,{path:"/welcome",exact:!0,component:k}),Object(h.jsx)(l.b,{path:"/createpost",exact:!0,component:U}),Object(h.jsx)(l.b,{path:"/home",exact:!0,component:q}),Object(h.jsx)(l.b,{path:"/post/:postId",exact:!0,component:B}),Object(h.jsx)(l.b,{path:"/editpost/:postId",exact:!0,component:z}),Object(h.jsx)(l.b,{path:"/chat",exact:!0,component:H}),Object(h.jsx)(l.b,{path:"/requests",exact:!0,component:K}),Object(h.jsx)(l.b,{path:"/telebot",exact:!0,component:Q}),Object(h.jsx)(l.b,{path:"/search",component:L}),Object(h.jsx)(l.b,{path:"/",component:S})]})})})},Z=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,168)).then((function(t){var c=t.getCLS,n=t.getFID,a=t.getFCP,s=t.getLCP,r=t.getTTFB;c(e),n(e),a(e),s(e),r(e)}))};r.a.render(Object(h.jsx)(a.a.StrictMode,{children:Object(h.jsx)(X,{})}),document.getElementById("root")),Z()},35:function(e,t,c){},64:function(e,t,c){},90:function(e,t,c){}},[[156,1,2]]]);
//# sourceMappingURL=main.b2815793.chunk.js.map